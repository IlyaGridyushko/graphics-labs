# Лабораторная работа 2: Обработка цифровых изображений

## Пояснения к методам обработки изображений

### 1. Гистограммы и контрастирование

#### Построение гистограммы
Гистограмма изображения показывает распределение яркостей пикселей. По оси X отложены значения яркости (0-255), по оси Y — количество пикселей с данной яркостью.

#### Эквализация гистограммы
Метод выравнивания гистограммы преобразует распределение яркостей так, чтобы все уровни яркости использовались равномерно. Это повышает контраст изображения.

**Алгоритм:**
1. Построить гистограмму исходного изображения
2. Вычислить функцию кумулятивного распределения (CDF)
3. Нормализовать CDF к диапазону [0, 255]
4. Использовать нормализованную CDF как таблицу преобразования

**Сравнение подходов для цветных изображений:**

- **RGB эквализация**: Выравнивает гистограмму каждого цветового канала независимо
  - Преимущества: Максимальное увеличение контраста
  - Недостатки: Может вызвать искажение цветов
  
- **HSV эквализация**: Выравнивает только канал яркости (V) в цветовом пространстве HSV
  - Преимущества: Сохраняет исходные цвета
  - Недостатки: Меньший эффект на контраст

**Рекомендуется использовать:**
- RGB эквализацию для монохромных или серых изображений
- HSV эквализацию для сохранения естественных цветов на фотографиях

#### Линейное контрастирование
Преобразование вида: `new_value = alpha * old_value + beta`

- `alpha > 1`: Увеличение контраста
- `alpha < 1`: Уменьшение контраста
- `beta > 0`: Увеличение яркости
- `beta < 0`: Уменьшение яркости

**Автоматическое линейное контрастирование** растягивает диапазон значений от минимума до максимума на полный диапазон [0, 255].

### 2. Фильтры низких частот (сглаживающие)

Используются для уменьшения шума и размытия изображения.

#### Усредняющий фильтр
Заменяет значение каждого пикселя средним значением пикселей в окрестности.

**Применение:**
- Удаление мелкозернистого шума
- Подготовка к обнаружению краёв
- Упрощение изображения

**Недостаток:** Размывает края объектов

#### Гауссовский фильтр
Взвешенное усреднение с весами, распределёнными по закону Гаусса.

**Параметры:**
- Размер ядра: Чем больше, тем сильнее размытие
- Sigma (σ): Стандартное отклонение, определяет степень размытия

**Преимущества перед усредняющим:**
- Более естественное размытие
- Лучше сохраняет края при умеренных значениях sigma

**Тестовые изображения:**
- `noisy.png` - изображение с шумом типа "соль и перец"
- `blurred.png` - уже размытое изображение (для сравнения результатов)

### 3. Фильтры высоких частот (увеличение резкости)

Используются для выделения мелких деталей и краёв.

#### Фильтр резкости (Sharpen)
Усиливает различия между соседними пикселями, выделяя границы.

#### Лапласиан (Laplacian)
Оператор второй производной, чувствителен к быстрым изменениям яркости.

**Применение:**
- Обнаружение краёв
- Усиление контуров

#### Маска нерезкости (Unsharp Masking)
Продвинутый метод увеличения резкости:
1. Создаёт размытую версию изображения
2. Вычитает её из оригинала, получая "маску"
3. Добавляет усиленную маску обратно к оригиналу

**Параметр amount**: Определяет силу эффекта (рекомендуется 1.0-2.0)

**Тестовые изображения:**
- `blurred.png` - размытое изображение для проверки увеличения резкости

### 4. Нелинейные фильтры (порядковые статистики)

Работают на основе упорядочивания значений в окрестности пикселя.

#### Медианный фильтр
Заменяет значение пикселя медианой значений в окрестности.

**Преимущества:**
- Отлично удаляет импульсный шум ("соль и перец")
- Сохраняет края лучше, чем линейные фильтры

**Применение:** Предобработка зашумлённых изображений

#### Минимальный и максимальный фильтры
- **Min фильтр**: Эрозия (сжатие светлых областей)
- **Max фильтр**: Дилатация (расширение светлых областей)

**Тестовые изображения:**
- `noisy.png` - идеально подходит для демонстрации медианного фильтра

### 5. Глобальная пороговая обработка

Бинаризация изображения с использованием одного порога для всего изображения.

#### Метод Оцу (Otsu)
Автоматический выбор порога на основе максимизации межклассовой дисперсии.

**Алгоритм:**
1. Вычислить гистограмму
2. Для каждого возможного порога вычислить межклассовую дисперсию
3. Выбрать порог с максимальной дисперсией

**Преимущества:**
- Полностью автоматический
- Оптимален для изображений с бимодальной гистограммой

**Недостатки:**
- Плохо работает при неравномерном освещении
- Требует чёткого разделения объекта и фона

#### Фиксированный порог
Пользователь задаёт значение порога вручную.

**Применение:** Когда известны характеристики изображения

#### Средний порог
Использует среднее значение яркости всех пикселей как порог.

**Применение:** Простой метод для изображений с равномерным освещением

### 6. Локальная пороговая обработка

Вычисляет индивидуальный порог для каждого пикселя на основе его окрестности.

#### Адаптивная пороговая обработка
Порог для каждого пикселя: `T(x,y) = mean(x,y) - C`

**Параметры:**
- Block Size: Размер окрестности
- C: Константа коррекции

**Применение:** Изображения с переменным освещением

#### Метод Ниблака (Niblack)
`T(x,y) = mean(x,y) + k * stddev(x,y)`

**Параметры:**
- Window Size: Размер окна
- k: Весовой коэффициент (обычно -0.2 до 0.2)

**Применение:** Бинаризация текстовых документов

#### Метод Сауволы (Sauvola)
Улучшенная версия метода Ниблака:
`T(x,y) = mean(x,y) * [1 + k * (stddev(x,y)/R - 1)]`

где R — динамический диапазон стандартного отклонения (обычно 128)

**Преимущества:**
- Лучше работает с документами
- Меньше шума в результате

**Сравнение методов:**
- **Глобальные** методы быстрее, но менее адаптивны
- **Локальные** методы лучше для изображений с переменным освещением
- **Оцу** vs **Адаптивный**: Оцу для простых сцен, адаптивный для сложных
- **Ниблак** vs **Саувола**: Саувола даёт меньше шума

### 7. Сегментация: обнаружение краёв

#### Оператор Собеля (Sobel)
Использует свёртку с двумя ядрами (горизонтальным и вертикальным) для вычисления градиента.

**Ядра:**
```
Gx = [-1  0  1]     Gy = [-1 -2 -1]
     [-2  0  2]          [ 0  0  0]
     [-1  0  1]          [ 1  2  1]
```

**Величина градиента:** `|G| = sqrt(Gx² + Gy²)`

#### Оператор Превитта (Prewitt)
Альтернатива Собелю с равными весами:

**Ядра:**
```
Gx = [-1  0  1]     Gy = [-1 -1 -1]
     [-1  0  1]          [ 0  0  0]
     [-1  0  1]          [ 1  1  1]
```

#### Алгоритм Кенни (Canny)
Многоэтапный алгоритм обнаружения краёв:

1. **Размытие Гаусса** - удаление шума
2. **Вычисление градиента** - использует Собеля
3. **Подавление немаксимумов** - истончение краёв
4. **Двойная пороговая фильтрация** - два порога для сильных и слабых краёв
5. **Трассировка краёв** - соединение слабых краёв с сильными

**Параметры:**
- Low Threshold: Порог для слабых краёв
- High Threshold: Порог для сильных краёв

**Преимущества:**
- Лучшее обнаружение краёв
- Тонкие одиночные линии

**Сравнение:**
- **Собель/Превитт**: Быстрые, простые, дают толстые края
- **Кенни**: Медленнее, но даёт лучшие результаты с тонкими краями

### 8. Морфологические операции

Работают с бинарными или полутоновыми изображениями, используя структурирующий элемент.

#### Эрозия (Erosion)
Уменьшает (разъедает) светлые области.

**Применение:**
- Удаление мелких светлых объектов
- Разделение соединённых объектов

#### Дилатация (Dilation)
Увеличивает светлые области.

**Применение:**
- Заполнение дыр в объектах
- Соединение близких объектов

#### Открытие (Opening)
Эрозия, затем дилатация.

**Применение:**
- Удаление шума (мелких светлых объектов)
- Сохранение размера основных объектов

#### Замыкание (Closing)
Дилатация, затем эрозия.

**Применение:**
- Заполнение дыр в объектах
- Соединение близких объектов
- Сглаживание контуров

#### Структурирующие элементы

- **Прямоугольник**: Универсальный, изотропный
- **Крест**: Менее агрессивный, сохраняет угловые особенности
- **Эллипс**: Наиболее изотропный, хорош для округлых объектов

**Выбор элемента:**
- Размер: Определяет масштаб операции
- Форма: Должна соответствовать форме объектов на изображении

**Рекомендации:**
- Начинайте с малых размеров (3x3, 5x5)
- Открытие хорошо для удаления шума
- Замыкание хорошо для заполнения пробелов

## Подбор тестовых изображений

### Для каждого метода подобраны специальные изображения:

1. **Низкоконтрастные** (`low_contrast.png`) - для методов контрастирования и эквализации гистограммы
2. **Зашумлённые** (`noisy.png`) - для фильтров сглаживания и нелинейных фильтров
3. **Размытые** (`blurred.png`) - для фильтров повышения резкости
4. **Геометрические фигуры** (`test.png`) - для обнаружения краёв и морфологических операций

### Рекомендации по тестированию:

- **Эквализация гистограммы**: Используйте `low_contrast.png`
- **Медианный фильтр**: Используйте `noisy.png` - покажет отличное удаление шума
- **Гауссовский фильтр**: Используйте `noisy.png` - покажет сглаживание
- **Увеличение резкости**: Используйте `blurred.png`
- **Обнаружение краёв**: Используйте `test.png` - чёткие геометрические формы
- **Пороговая обработка**: Любое изображение после преобразования в оттенки серого

## Критерии оценки (100 баллов)

✅ **Корректность работы методов** (50 баллов):
- Все методы реализованы и работают корректно
- Используются стандартные алгоритмы из литературы
- Результаты соответствуют ожидаемым

✅ **Подборка подходящих изображений** (20 баллов):
- Подобраны тестовые изображения для каждой категории методов
- Изображения демонстрируют сильные и слабые стороны методов
- Включены различные типы искажений

✅ **Пояснения** (30 баллов):
- Подробное описание каждого метода
- Объяснение параметров и их влияния
- Сравнение методов между собой
- Рекомендации по применению

## Литература и источники

1. Gonzalez, R. C., & Woods, R. E. (2018). Digital Image Processing (4th ed.). Pearson.
2. Szeliski, R. (2022). Computer Vision: Algorithms and Applications (2nd ed.).
3. OpenCV Documentation: Image Processing modules
4. Otsu, N. (1979). "A threshold selection method from gray-level histograms". IEEE Trans. Sys., Man., Cyber.
5. Canny, J. (1986). "A Computational Approach to Edge Detection". IEEE Trans. Pattern Analysis and Machine Intelligence.
